<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Catégorie dédiée GED -->
    <record id="module_category_ged_controls" model="ir.module.category">
        <field name="name">GED Contrôles</field>
        <field name="description">Gestion des accès aux documents GED</field>
        <field name="sequence">20</field>
    </record>

    <!-- Groupes de sécurité GED -->
    <record id="group_ged_user" model="res.groups">
        <field name="name">GED User</field>
        <field name="category_id" ref="module_category_ged_controls"/>
        <field name="comment">Peut accéder aux documents GED en lecture</field>
    </record>
    
    <record id="group_ged_manager" model="res.groups">
        <field name="name">GED Manager</field>
        <field name="category_id" ref="module_category_ged_controls"/>
        <field name="implied_ids" eval="[(4, ref('group_ged_user'))]"/>
        <field name="comment">Peut gérer les permissions GED des projets</field>
    </record>

    <!-- Groupes spécifiques par projet -->
    <record id="group_ged_innovation" model="res.groups">
        <field name="name">GED Innovation (Axe 1)</field>
        <field name="category_id" ref="module_category_ged_controls"/>
        <field name="implied_ids" eval="[(4, ref('group_ged_user'))]"/>
    </record>
    
    <record id="group_ged_expansion" model="res.groups">
        <field name="name">GED Expansion (Axe 2)</field>
        <field name="category_id" ref="module_category_ged_controls"/>
        <field name="implied_ids" eval="[(4, ref('group_ged_user'))]"/>
    </record>
    
    <record id="group_ged_gouvernance" model="res.groups">
        <field name="name">GED Gouvernance (Axe 3)</field>
        <field name="category_id" ref="module_category_ged_controls"/>
        <field name="implied_ids" eval="[(4, ref('group_ged_user'))]"/>
    </record>

    <!-- Règles d'accès par projet -->
    <record id="rule_project_innovation_access" model="ir.rule">
        <field name="name">Accès Innovation uniquement</field>
        <field name="model_id" ref="project.model_project_project"/>
        <field name="groups" eval="[(4, ref('group_ged_innovation'))]"/>
        <field name="domain_force">[('x_department', '=', 'innovation')]</field>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>
    
    <record id="rule_project_expansion_access" model="ir.rule">
        <field name="name">Accès Expansion uniquement</field>
        <field name="model_id" ref="project.model_project_project"/>
        <field name="groups" eval="[(4, ref('group_ged_expansion'))]"/>
        <field name="domain_force">[('x_department', '=', 'expansion')]</field>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>
    
    <record id="rule_project_gouvernance_access" model="ir.rule">
        <field name="name">Accès Gouvernance uniquement</field>
        <field name="model_id" ref="project.model_project_project"/>
        <field name="groups" eval="[(4, ref('group_ged_gouvernance'))]"/>
        <field name="domain_force">[('x_department', '=', 'gouvernance')]</field>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>
</odoo>